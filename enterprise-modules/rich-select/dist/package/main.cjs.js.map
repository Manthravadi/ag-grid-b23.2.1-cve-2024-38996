{
  "version": 3,
  "sources": ["../../src/main.ts", "../../src/richSelectModule.ts", "../../src/richSelect/richSelectCellEditor.ts", "../../src/version.ts"],
  "sourcesContent": ["export { RichSelectModule } from './richSelectModule';\n", "import type { Module } from '@ag-grid-community/core';\nimport { ModuleNames, _EditCoreModule } from '@ag-grid-community/core';\nimport { EnterpriseCoreModule } from '@ag-grid-enterprise/core';\n\nimport { RichSelectCellEditor } from './richSelect/richSelectCellEditor';\nimport { VERSION } from './version';\n\nexport const RichSelectModule: Module = {\n    version: VERSION,\n    moduleName: ModuleNames.RichSelectModule,\n    beans: [],\n    userComponents: [\n        { name: 'agRichSelect', classImp: RichSelectCellEditor },\n        { name: 'agRichSelectCellEditor', classImp: RichSelectCellEditor },\n    ],\n    dependantModules: [EnterpriseCoreModule, _EditCoreModule],\n};\n", "import type {\n    FieldPickerValueSelectedEvent,\n    ICellEditor,\n    ICellEditorParams,\n    KeyCreatorParams,\n    RichCellEditorParams,\n    RichSelectParams,\n} from '@ag-grid-community/core';\nimport { PopupComponent, _missing, _warnOnce } from '@ag-grid-community/core';\nimport { AgRichSelect } from '@ag-grid-enterprise/core';\n\nexport class RichSelectCellEditor<TData = any, TValue = any> extends PopupComponent implements ICellEditor<TValue> {\n    private params: RichCellEditorParams<TData, TValue>;\n    private focusAfterAttached: boolean;\n    private richSelect: AgRichSelect<TValue>;\n\n    constructor() {\n        super(/* html */ `<div class=\"ag-cell-edit-wrapper\"></div>`);\n    }\n\n    public init(params: RichCellEditorParams<TData, TValue>): void {\n        this.params = params;\n\n        const { cellStartedEdit, values } = params;\n\n        if (_missing(values)) {\n            _warnOnce('agRichSelectCellEditor requires cellEditorParams.values to be set');\n        }\n\n        const { params: richSelectParams, valuesPromise } = this.buildRichSelectParams();\n\n        this.richSelect = this.createManagedBean(new AgRichSelect<TValue>(richSelectParams));\n        this.richSelect.addCssClass('ag-cell-editor');\n        this.appendChild(this.richSelect);\n\n        if (valuesPromise) {\n            valuesPromise.then((values: TValue[]) => {\n                this.richSelect.setValueList({ valueList: values, refresh: true });\n                const searchStringCallback = this.getSearchStringCallback(values);\n                if (searchStringCallback) {\n                    this.richSelect.setSearchStringCreator(searchStringCallback);\n                }\n            });\n        }\n\n        this.addManagedListeners(this.richSelect, {\n            fieldPickerValueSelected: this.onEditorPickerValueSelected.bind(this),\n        });\n        this.focusAfterAttached = cellStartedEdit;\n    }\n\n    private onEditorPickerValueSelected(e: FieldPickerValueSelectedEvent): void {\n        this.params.stopEditing(!e.fromEnterKey);\n    }\n\n    private buildRichSelectParams(): { params: RichSelectParams<TValue>; valuesPromise?: Promise<TValue[]> } {\n        const {\n            cellRenderer,\n            cellHeight,\n            value,\n            values,\n            formatValue,\n            searchDebounceDelay,\n            valueListGap,\n            valueListMaxHeight,\n            valueListMaxWidth,\n            allowTyping,\n            filterList,\n            searchType,\n            highlightMatch,\n            valuePlaceholder,\n            eventKey,\n            multiSelect,\n            suppressDeselectAll,\n            suppressMultiSelectPillRenderer,\n        } = this.params;\n\n        const ret: RichSelectParams = {\n            value: value,\n            cellRenderer,\n            cellRowHeight: cellHeight,\n            searchDebounceDelay,\n            valueFormatter: formatValue,\n            pickerAriaLabelKey: 'ariaLabelRichSelectField',\n            pickerAriaLabelValue: 'Rich Select Field',\n            pickerType: 'virtual-list',\n            pickerGap: valueListGap,\n            allowTyping,\n            filterList,\n            searchType,\n            highlightMatch,\n            maxPickerHeight: valueListMaxHeight,\n            maxPickerWidth: valueListMaxWidth,\n            placeholder: valuePlaceholder,\n            initialInputValue: eventKey?.length === 1 ? eventKey : undefined,\n            multiSelect,\n            suppressDeselectAll,\n            suppressMultiSelectPillRenderer,\n        };\n\n        let valuesResult;\n        let valuesPromise;\n\n        if (typeof values === 'function') {\n            valuesResult = values(this.params as ICellEditorParams);\n        } else {\n            valuesResult = values ?? [];\n        }\n\n        if (Array.isArray(valuesResult)) {\n            ret.valueList = valuesResult;\n            ret.searchStringCreator = this.getSearchStringCallback(valuesResult);\n        } else {\n            valuesPromise = valuesResult;\n        }\n\n        if (multiSelect && allowTyping) {\n            this.params.allowTyping = ret.allowTyping = false;\n            _warnOnce(\n                'agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.'\n            );\n        }\n\n        return { params: ret, valuesPromise };\n    }\n\n    private getSearchStringCallback(values: TValue[]): ((values: TValue[]) => string[]) | undefined {\n        const { colDef } = this.params;\n\n        if (typeof values[0] !== 'object' || !colDef.keyCreator) {\n            return;\n        }\n\n        return (values: TValue[]) =>\n            values.map((value: TValue) => {\n                const keyParams: KeyCreatorParams = this.gos.addGridCommonParams({\n                    value: value,\n                    colDef: this.params.colDef,\n                    column: this.params.column,\n                    node: this.params.node,\n                    data: this.params.data,\n                });\n                return colDef.keyCreator!(keyParams);\n            });\n    }\n\n    // we need to have the gui attached before we can draw the virtual rows, as the\n    // virtual row logic needs info about the gui state\n    public afterGuiAttached(): void {\n        const { focusAfterAttached, params } = this;\n\n        setTimeout(() => {\n            if (!this.isAlive()) {\n                return;\n            }\n\n            if (focusAfterAttached) {\n                const focusableEl = this.richSelect.getFocusableElement() as HTMLInputElement;\n                focusableEl.focus();\n                const { allowTyping, eventKey } = this.params;\n                if (allowTyping && (!eventKey || eventKey.length !== 1)) {\n                    focusableEl.select();\n                }\n            }\n\n            this.richSelect.showPicker();\n\n            const { eventKey } = params;\n            if (eventKey) {\n                if (eventKey?.length === 1) {\n                    this.richSelect.searchTextFromString(eventKey);\n                }\n            }\n        });\n    }\n\n    public focusIn(): void {\n        this.richSelect.getFocusableElement().focus();\n    }\n\n    public getValue(): any {\n        return this.richSelect.getValue();\n    }\n\n    public override isPopup(): boolean {\n        return false;\n    }\n}\n", "// DO NOT UPDATE MANUALLY: Generated from script during build time\nexport const VERSION = '31.3.1';\n"],
  "mappings": "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",
  "names": ["import_core", "import_core", "values", "eventKey"]
}
